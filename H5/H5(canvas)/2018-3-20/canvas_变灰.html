<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        body {
            text-align: center;
            background: #000;
        }

        canvas {
            background: #fff;
        }
    </style>
    <script>
        window.onload = function () {
            let oC = document.querySelector('canvas'),
                gd = oC.getContext('2d')

            let oImg = new Image()

            oImg.src = '1.jpg'

            oImg.onload = function () {
                
                gd.drawImage(oImg,0,0)

                let imgData  = gd.getImageData(0,0,oC.width,oC.height),//获取像素点的数组(rgba)
                    W = oC.width,H =oC.height,data = imgData.data

                for(let r=0;r<=H;r++){
                    for (let c = 0; c <=W; c++) {
                        data[(r*W+c)*4 + 0] = data[ (r * W + c)*4 +1 ] = data[(r * W + c )*4+ 2] = (data[(r * W + c) * 4 + 0] + data[(r * W + c) * 4 + 1] + data[(r * W + c) * 4 + 2]) /3
                    }
                }
                
                gd.clearRect(0,0,W,H)

                gd.putImageData(imgData,0,0)

            }
        }
    </script>
</head>

<body>
    <canvas width="330" height="498"></canvas>
</body>

</html>device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    
</body>
</html>